@using NWebsec.Mvc.HttpHeaders.Csp
@{
    ViewBag.Title = "nTest - Edit Credit Collateral";
    ViewBag.AngularDeclaration = "ng-app=\"app\" ng-controller=\"editCreditCollateralCtr as c\" ng-cloak";
    ViewBag.LoaderDeclaration = "ng-show=\"c.isLoading===true\"";
}

@section Scripts {
    <script @Html.CspScriptNonce()>
        var initialData = JSON.parse(atob('@Html.Raw(ViewBag.JsonInitialData)'))
    </script>
    @Scripts.Render("~/Content/js/bundle-edit-creditcollateral")
}

<div class="pb-2"><a class="n-back" href="@(new Uri(NEnv.ServiceRegistry.External["nTest"]).ToString())"><span class="glyphicon glyphicon-arrow-left"></span></a></div>
<div class="row">
    <div class="col-sm-12">
        <div ng-if="c.initial">
            <h1>Edit credit collateral</h1>

            <form class="form-horizontal">
                <div class="form-group">
                    <label class="col-sm-4 control-label">Credit nr</label>
                    <div class="col-sm-8">
                        <input type="text" ng-model="c.initial.creditNr" class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-10">
                        <p class="form-control-static">
                            <button class="btn btn-default" ng-click="c.loadCredit($event)">Load credit</button>
                        </p>
                    </div>
                </div>
            </form>
        </div>

        <div ng-if="c.edit" style="height: 800px">
            <h1>Edit</h1>
            <angular-jsoneditor ng-model="c.edit.model" options="{mode : 'code', modes: ['code', 'tree']}" style="width: 100%"></angular-jsoneditor>
            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-default" ng-click="c.saveEdit($event)">Save edit</button>
                </div>
            </div>
        </div>
    </div>
    <div class="col-sm-5">
    </div>
</div>